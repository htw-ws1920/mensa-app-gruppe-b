<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Eat App</title>
  <!-- materialize icons, css & js -->
  <link type="text/css" href="/css/materialize.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link type="text/css" href="/css/styles.css" rel="stylesheet">
  <script type="text/javascript" src="/js/materialize.min.js"></script>
  <link rel="manifest" href="/manifest.json">
</head>
<body class="grey lighten-4">

  <!-- top navbar -->
  <div class="top-navbar">
    <a id="logo" href="/pages/dashboard.html" class="brand-logo"><img src="/img/logo_no_font.png" width="25" height="30"></a>
    <div id="canteen-info">
    </div>
    <a id="calendar" href="#"><i class="material-icons">today</i></a>
  </div>

  <!-- bottom navbar -->
  <div class="bottom-navbar">
    <a id="active" href="/pages/dashboard.html"><i class="material-icons">dashboard</i></a>
    <a href="/pages/search.html"><i class="material-icons">search</i></a>
    <a href="/pages/favorites.html"><i class="material-icons">grade</i></a>
    <a href="/pages/notifications.html"><i class="material-icons">notifications</i></a>
    <a href="/pages/profile.html"><i class="material-icons">person</i></a>
  </div>

  <!-- content -->
  <div class="meals-headline">
    <a id="speiseplan"href="#">Speiseplan</a>
    <a id="prev-day" href="#"><i class="material-icons">keyboard_arrow_left</i></a>
    <a id="next-day" onclick="getDate()" class="btn" href="#"><i class="material-icons">keyboard_arrow_right</i></a>
    <a id="filter" href="#"><i class="material-icons">tune</i></a>
    <a id="download" href="#"><i class="material-icons">file_download</i></a>
  </div>

  <div class="meals container">
    <div id="meals-box" class="card-panel meal">
      <a id="meal-category">Category</a>
      <a id="meal-title" href="#">Name</a>
      <a id="meal-price">Preise</a>
    </div>
  </div>

  <script>
  var data;
  function increaseDate() {
    currentDate.setDate(currentDate.getDate()+1)
    var year = currentDate.getFullYear();
    var month = currentDate.getMonth() +1;
    var day = currentDate.getDate();
    getMeals(localStorage.getItem('id'), year, month, day).then(response => {
      data = JSON.stringify(response);
    })
  }

  function decreaseDate() {
      currentDate.setDate(currentDate.getDate()-1)
      var year =currentDate.getFullYear();
      var month = currentDate.getMonth() +1;
      var day = currentDate.getDate();
      getMeals(localStorage.getItem('id'), year, month, day).then(response => {
        data = JSON.parse(response);
      })
  }

  function getDate() {
    currentDate = new Date();
    var year =currentDate.getFullYear();
    var month = currentDate.getMonth() +1;
    var day = currentDate.getDate();
    getMeals(localStorage.getItem('id'), year, month, day).then(response => {
      data = response;
      console.log(data);
    })
    console.log(data);
  }

  function getMeals(canteen, year, month, day){
    var adress = 'https://openmensa.org/api/v2/canteens/'+canteen+'/days/'+year+'-'+month+'-'+day+'/meals';

    console.log(adress);
    return fetch(adress, {
        method: 'get',
        headers: {
            "Content-Type": "application/json; charset=utf-8"
        },
        mode: "cors"
    })
    .then(response => {
        if (response.status !== 200 ) {
            console.log('Looks like there was a problem. Status Code: ' +
                response.status );
            return;
        }
        return response.json();
    })                
    .catch(err =>{
        console.log('Fetch Error :-S', err );
    });
  }
  </script>

  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-firestore.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
      https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/7.6.1/firebase-analytics.js"></script>

  <script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyAOwj2f8HROjuUxMO-mhIQ-T_gHCWL6cYM",
    authDomain: "pwa-mensa-app.firebaseapp.com",
    databaseURL: "https://pwa-mensa-app.firebaseio.com",
    projectId: "pwa-mensa-app",
    storageBucket: "pwa-mensa-app.appspot.com",
    messagingSenderId: "727750551344",
    appId: "1:727750551344:web:9bd391ce86abed60e7caf5",
    measurementId: "G-P27QQMBJ30"
  };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
    const db = firebase.firestore();
  </script>

  <script src="/js/app.js"></script>
  <script src="/js/db-canteen-info.js"></script>
  <script src="/js/ui.js"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
</body>
</html>